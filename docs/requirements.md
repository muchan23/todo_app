# 日記アプリ要件定義書

## 1. 目的・スコープ

### 目的
その日の出来事を素早く書き留め、同一画面で下部に時系列で蓄積・閲覧できる。

### 対象
- 単一ユーザー／単一端末
- ログインなし
- オフライン対応

### 技術前提
- TypeScript／Next.js（App Router）
- **ブラウザ保存（IndexedDB）**を利用
- サーバ通信なし

## 2. 機能要件（MVP）

### 入力欄
- 画面中央に複数行テキストエリアを1つ配置
- プレースホルダ文言：「今日の出来事を書いてください」
- 追加操作：
  - ①「追加」ボタン
  - ②⌘/Ctrl+Enter
- 空白のみは登録不可（エラーメッセージ表示）

### 記録の蓄積表示
- 入力欄の下部に一覧表示
- 新しい順（降順）
- 各項目は「本文」「作成日時（日本時間）」を表示
- 1項目ごとに削除ボタンを配置（行単位の削除のみ）

### 日付の扱い
- 保存は ISO8601（UTC）
- 表示は Asia/Tokyo ローカル
- 「今日」の基準：端末のローカル日付（00:00–23:59）

### 保存／復元
- IndexedDB（fallback: localStorage）へ自動保存
- アプリ再読み込み時に直前の状態を復元

### 操作補助（最小）
- 入力中の文字数カウント（任意）
- 削除直後のUndo（5秒）（任意・実装推奨）

## 3. 非機能要件

### 性能
- 記録1,000件時でも一覧スクロール・追加・削除が体感100ms以内

### 可用性
- オフライン完全動作（初回アクセス後）

### アクセシビリティ
- キーボード操作完結
- フォーカス可視
- ボタンのラベル適切

### 信頼性
- 書込失敗時はユーザー通知＋再試行手段を提供

### セキュリティ
- データは端末ローカルのみ
- 外部送信なし

### 型安全
- any禁止
- ESLint/Prettier適用

## 4. データモデル（概念）

### Entry
```typescript
interface Entry {
  id: string;        // UUID
  text: string;      // 1〜10,000文字
  createdAt: string; // ISO8601 UTC
}
```

### State
```typescript
interface State {
  entries: Entry[];
}
```

## 5. バリデーション／メッセージ

- **追加時**: `text.trim().length > 0` を満たすこと
- **上限超過時**: 「1万文字を超えています」
- **保存失敗時**: 「保存に失敗しました。再試行してください。」
- **削除確認（任意）**: 「この記録を削除しますか？」

## 6. UI要件

### レイアウト
- **上部（ヘッダー簡易）**: 日付（YYYY/MM/DD）表示のみ（任意）
- **中央**: テキストエリア＋「追加」ボタン
- **下部**: 記録リスト（本文は改行保持／折返し、日時は右下などに小さく）

### テーマ
- OSのダーク／ライトに追随（任意）

### 空状態
- 記録がない場合は「まだ記録がありません」などの案内を表示

## 7. Next.js特記事項

- IndexedDBはクライアント側のみで利用（"use client"コンポーネント、useEffect内で初期化）
- SSR中はデータ未取得のため、初期は空表示→クライアントマウント後に復元

## 8. エラーハンドリング

- **保存失敗**: 非モーダルのトーストorバナーで通知、再試行ボタン（任意）
- **復元失敗（破損）**: 安全な初期化＋バックアップ領域へ待避（任意）

## 9. 受け入れ基準（Acceptance Criteria）

- **AC-01**: 本文入力→「追加」または⌘/Ctrl+Enterで送信→一覧先頭に即時表示
- **AC-02**: ページ再読み込み後も直前までの記録が復元される
- **AC-03**: 空白のみ入力で追加操作→登録されず警告表示
- **AC-04**: 削除ボタン操作→当該記録が一覧から消える（Undo実装時は復元可）
- **AC-05**: 当日作成の記録日時が日本時間で正しく表示される

## 10. 範囲外（本MVPでは実施しない）

- 編集、検索、タグ、並び替え変更
- 共有、通知、PWA配布
- クラウド同期、認証

## 11. 将来拡張（参考）

- 編集／検索／日別アーカイブ
- Markdown表示
- エクスポート（JSON/Markdown）
- PWA化
- サーバ同期（PostgreSQL＋Prisma など）

---

**作成日**: 2024年12月
**バージョン**: 1.0
**ステータス**: 承認済み
